
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="topic"/>
<meta name="DC.Title" content="数据库性能监控工具 — sdbtop"/>
<meta name="description" content="sdbtop 是一个 SequoiaDB 数据库的性能监控工具。通过它，可以监控和查看集群中各个节点的监视信息。 选项 参数 缩写 描述 --help -h 返回基本帮助和用法文本 --confpath -c sdbtop 的配置文件，sdbtop 界面形态以及输出字段都依赖该文件（缺省使用默认配置文件） --hostname -i 指定需要监控的主机名 --servicename -s ..."/>
<meta name="DC.Relation" scheme="URI" content="../../../../administration/database/database_tool/topics/database_tool.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="topic_bvt_f2m_54"/>
<link rel="stylesheet" type="text/css" href="../../../../commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../../../assets/webhelp_topic.css"/>
<title>数据库性能监控工具 — sdbtop</title>
<script type="text/javascript" src="../../../../assets/jquery-1.3.2.js"> </script><script type="text/javascript" src="../../../../assets/jquery-ui-1.8.2.custom.min.js"> </script><script type="text/javascript" src="../../../../assets/frames_redirect.js"> </script><script type="text/javascript"><!--
    var prefix = "../../../../../index.html";
    var ratingFile = "";
    redirectToToc(window.location.search);
    function highlightSearchTerm(){
        if(parent.termsToHighlight != null){
        // highlight each term in the content view  
          for(i = 0 ; i < parent.termsToHighlight.length ; i++){        
              $('*', window.parent.frames[1].document).highlight(parent.termsToHighlight[i]);
          }
        }
    }
//--></script></head>
<body onload="highlightSearchTerm()" id="topic_bvt_f2m_54"><a name="topic_bvt_f2m_54"><!-- --></a>
<table class="nav"><tbody><tr><td><div class="navheader"><span class="frames" onclick="redirectFrames(location.pathname)"><script type="text/javascript"><!--
  if (parent.window.location.pathname == window.location.pathname ) document.write('With Frames');                    
                    --></script></span><a class="link" href="../../../../administration/database/database_tool/topics/database_tool.html" title="数据库工具"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">数据库工具</span></a>  </div></td><td width="50%"><a class="navheader_parent_path" href="../../topics/database.html" title="数据库管理">数据库管理</a> / <a class="navheader_parent_path" href="../../../../administration/database/database_tool/topics/database_tool.html" title="数据库工具">数据库工具</a></td></tr></tbody></table>

  <h1 class="title topictitle1">数据库性能监控工具 — sdbtop</h1>

  <div class="body">
    <p class="p">sdbtop 是一个 SequoiaDB 数据库的性能监控工具。通过它，可以监控和查看集群中各个节点的监视信息。</p>
    
    <div class="section"><h2 class="title sectiontitle">选项</h2>
      
      <table cellpadding="4" cellspacing="0" summary="" border="1" class="simpletable"><tr class="sthead">
          <th valign="bottom" align="left" id="d22081e22" class="stentry">参数</th>

          <th valign="bottom" align="left" id="d22081e25" class="stentry">缩写</th>

          <th valign="bottom" align="left" id="d22081e28" class="stentry">描述</th>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e22" class="stentry">--help</td>

          <td valign="top" headers="d22081e25" class="stentry">-h</td>

          <td valign="top" headers="d22081e28" class="stentry">返回基本帮助和用法文本</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e22" class="stentry">--confpath</td>

          <td valign="top" headers="d22081e25" class="stentry">-c</td>

          <td valign="top" headers="d22081e28" class="stentry">sdbtop 的配置文件，sdbtop 界面形态以及输出字段都依赖该文件（缺省使用默认配置文件）</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e22" class="stentry">--hostname</td>

          <td valign="top" headers="d22081e25" class="stentry">-i</td>

          <td valign="top" headers="d22081e28" class="stentry">指定需要监控的主机名</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e22" class="stentry">--servicename</td>

          <td valign="top" headers="d22081e25" class="stentry">-s</td>

          <td valign="top" headers="d22081e28" class="stentry">指定监控的端口服务名</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e22" class="stentry">--usrname</td>

          <td valign="top" headers="d22081e25" class="stentry">-u</td>

          <td valign="top" headers="d22081e28" class="stentry">数据库用户名</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e22" class="stentry">--password</td>

          <td valign="top" headers="d22081e25" class="stentry">-p</td>

          <td valign="top" headers="d22081e28" class="stentry">数据库密码</td>

        </tr>
</table>

      <div class="p"><div class="note note"><span class="notetitle">Note:</span> 对于 Ubuntu 等系统，需要安装 Ncurses 库，否则将会提示“Error opening terminal: TERM”
        <div class="p">方式一： 联网安装<pre class="pre codeblock">sudo apt-get install libncurses5-dev</pre>
</div>

        <p class="p">方式二： 源码安装</p>
<div class="p">解压 tar -xvzf ncurses-5.5.tar.gz，进入 ncurses-5.5 目录<pre class="pre codeblock">./configure
sudo make &amp;&amp; make install</pre>
</div>
</div>
</div>

    </div>

    <div class="section"><h2 class="title sectiontitle">用法</h2>
      
      <p class="p">在下面的例子，sdbtop 使用配置文件为“/opt/sequoiadb/conf/sdbtop.xml”，监控主机名为 sdbserver3，端口服务名为11810，用户名为 test，密码为 test 的数据库集群中的一个节点。</p>

      <pre class="pre codeblock">sdbtop -c /opt/sequoiadb/conf/sdbtop.xml -i sdbserver3 -s 11810 -u test -p test</pre>

      <p class="p">接着进入主窗口：</p>
<pre class="pre codeblock">refresh= 3 secs                             sdbtop 1.0                        snapshotMode: GLOBAL
displayMode: ABSOLUTE                      Main Window                     snapshotModeInput: NULL
hostname: sdbserver3                                                           filtering Number: 0
servicename: 11810                                             sortingWay: NULL sortingField: NULL
usrName: test                                                        Refresh: F5, Quit: q, Help: h

 #####  ######  ######  #######  #####  ######   For help type h or ...
#       #     # #     #    #    #     # #     #  sdbtop -h: usage
#       #     # #     #    #    #     # #     #
 #####  #     # ######     #    #     # ######
      # #     # #     #    #    #     # #
      # #     # #     #    #    #     # #
 #####  ######  ######     #     #####  #

SDB Interactive Snapshot Monitor V2.0
Use these keys to navigate:
  m   -  Main Window            s   -  Sessions               c   -  CollectionSpaces
  t   -  System                 d   -  Database               G   -  GLOBAL_SNAPSHOT
  g   -  GROUP_SNAPSHOT         n   -  NODE_SNAPSHOT          r   -  reset refreshInterval
  A   -  Ascending order        D   -  Descending order       C   -  filter condition
  Q   -  no filter condition    N   -  filter number          W   -  no filter number






Licensed Materials - Property of SequoiaDB
Copyright SequoiaDB Corp. 2013-2014 All Rights Reserved.</pre>

    </div>

    <div class="note note"><span class="notetitle">Note:</span> 在主窗口中按‘<strong class="ph b">h</strong>’键可以查看所有工具支持的按键</div>

    <ul class="ul"><li class="li"><p class="p">主窗口按键说明</p>

      <table cellpadding="4" cellspacing="0" summary="" border="1" class="simpletable"><tr class="sthead">
          <th valign="bottom" align="left" id="d22081e154" class="stentry">参数</th>

          <th valign="bottom" align="left" id="d22081e157" class="stentry">描述</th>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">m</td>

          <td valign="top" headers="d22081e157" class="stentry">返回主窗口</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">s</td>

          <td valign="top" headers="d22081e157" class="stentry">列出数据库节点上的所有会话</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">c</td>

          <td valign="top" headers="d22081e157" class="stentry">列出数据库节点上的所有集合空间</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">t</td>

          <td valign="top" headers="d22081e157" class="stentry">列出数据库节点上的系统资源使用情况</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">d</td>

          <td valign="top" headers="d22081e157" class="stentry">列出数据库节点的数据库监视信息</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">G</td>

          <td valign="top" headers="d22081e157" class="stentry">global_snapshot，监控所有的数据节点组</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">g</td>

          <td valign="top" headers="d22081e157" class="stentry">group_snapshot，指定监控某个数据节点组</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">n</td>

          <td valign="top" headers="d22081e157" class="stentry">node_snapshot，列出指定的数据库节点的监视信息</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">r</td>

          <td valign="top" headers="d22081e157" class="stentry">设置刷屏的时间间隔，单位秒/s</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">A</td>

          <td valign="top" headers="d22081e157" class="stentry">将监视信息按照某列进行顺序排序</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">D</td>

          <td valign="top" headers="d22081e157" class="stentry">将监视信息按照某列进行逆序排序</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">C</td>

          <td valign="top" headers="d22081e157" class="stentry">将监视信息按照某个条件进行筛选</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">Q</td>

          <td valign="top" headers="d22081e157" class="stentry">返回没有使用条件进行筛选前的监视信息</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">N</td>

          <td valign="top" headers="d22081e157" class="stentry">将监视信息中对应行号的记录过滤不显示</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">W</td>

          <td valign="top" headers="d22081e157" class="stentry">返回没有使用行号进行过滤前的监视信息</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">h</td>

          <td valign="top" headers="d22081e157" class="stentry">查看使用帮助</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">Esc</td>

          <td valign="top" headers="d22081e157" class="stentry">取消已进入的操作</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">Enter</td>

          <td valign="top" headers="d22081e157" class="stentry">返回上一次监视界面，（在已进入 help 帮助输出中有效）</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">F5</td>

          <td valign="top" headers="d22081e157" class="stentry">强制刷新后台监视信息</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">&lt;</td>

          <td valign="top" headers="d22081e157" class="stentry">向左移动，以查看隐藏的左边列的监视信息</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">&gt;</td>

          <td valign="top" headers="d22081e157" class="stentry">向右移动，以查看隐藏的右边列的监视信息</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">q</td>

          <td valign="top" headers="d22081e157" class="stentry">退出程序</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d22081e154" class="stentry">Tab</td>

          <td valign="top" headers="d22081e157" class="stentry">切换数据计算的模式（绝对值，平均值，差值三个模式）</td>

        </tr>
</table>

    </li>
    
      <li class="li">
        <p class="p">例子一：</p>

        <p class="p">1. 进入主窗口后，按‘s’键，列出数据库节点的所有会话信息</p>

        <pre class="pre codeblock">refresh= 3 secs                             sdbtop 1.0                        snapshotMode: GLOBAL
displayMode: ABSOLUTE                        Sessions                      snapshotModeInput: NULL
hostname: sdbserver3                                                           filtering Number: 0
servicename: 11810                                             sortingWay: NULL sortingField: NULL
usrName: test                                                        Refresh: F5, Quit: q, Help: h

     SessionID                           TID Type               Name
     ------------------------------ -------- ------------------ ------------------------------
  1  sdbserver3:11820:1                10732 LogWriter          ""
  2  sdbserver3:11820:10               10741 Task               Job[Prefetcher]
  3  sdbserver3:11820:11               10742 Task               Job[Prefetcher]
  4  sdbserver3:11820:12               10743 Task               Job[Prefetcher]
  5  sdbserver3:11820:13               10744 Cluster            ""
  6  sdbserver3:11820:14               10745 ClusterShard       ""
  7  sdbserver3:11820:15               10746 ClusterLogNotify   ""
  8  sdbserver3:11820:16               10747 ShardReader        ""
  9  sdbserver3:11820:17               10748 ReplReader         ""
 10  sdbserver3:11820:18               10749 SyncClockWorker    ""
 11  sdbserver3:11820:19               10750 TCPListener        ""
 12  sdbserver3:11820:2                10733 DpsRollback        ""
 13  sdbserver3:11820:20               10751 RestListener       ""
 14  sdbserver3:11820:21               10752 Task               Job[PageCleaner]
 15  sdbserver3:11820:3                10734 Task               Job[Prefetcher]
 16  sdbserver3:11820:4                10735 Task               Job[Prefetcher]
 17  sdbserver3:11820:42               10847 ReplAgent          NodeID:1000,TID:1,Start:active
 18  sdbserver3:11820:5                10736 Task               Job[Prefetcher]
 19  sdbserver3:11820:59               23263 ShardAgent         NetID:1,TID:23262
 20  sdbserver3:11820:6                10737 Task               Job[Prefetcher]
 21  sdbserver3:11820:7                10738 Task               Job[Prefetcher]
 22  sdbserver3:11820:8                10739 Task               Job[Prefetcher]</pre>

        <p class="p">2. 按‘Tab’键，可以看到屏幕左上方的‘displayMode’的值会发生切换</p>

        <p class="p">3. 按‘r’键，在屏幕最下方输入‘2’，回车，设置刷新间隔时间，可以看到屏幕左上方的‘refresh’的值变为 2</p>

        <pre class="pre codeblock"><strong class="ph b">refresh= 2 secs</strong>                             sdbtop 1.0                        snapshotMode: GLOBAL
<strong class="ph b">displayMode: ABSOLUTE</strong>                        Sessions                      snapshotModeInput: NULL
hostname: sdbserver3                                                           filtering Number: 0
servicename: 11810                                             sortingWay: NULL sortingField: NULL
usrName: test                                                        Refresh: F5, Quit: q, Help: h

     SessionID                           TID Type               Name
     ------------------------------ -------- ------------------ ------------------------------
  1  sdbserver3:11820:1                10732 LogWriter          ""
  2  sdbserver3:11820:10               10741 Task               Job[Prefetcher]
  3  sdbserver3:11820:11               10742 Task               Job[Prefetcher]
  4  sdbserver3:11820:12               10743 Task               Job[Prefetcher]
  5  sdbserver3:11820:13               10744 Cluster            ""
  6  sdbserver3:11820:14               10745 ClusterShard       ""
  7  sdbserver3:11820:15               10746 ClusterLogNotify   ""
  8  sdbserver3:11820:16               10747 ShardReader        ""
  9  sdbserver3:11820:17               10748 ReplReader         ""
 10  sdbserver3:11820:18               10749 SyncClockWorker    ""
 11  sdbserver3:11820:19               10750 TCPListener        ""
 12  sdbserver3:11820:2                10733 DpsRollback        ""
 13  sdbserver3:11820:20               10751 RestListener       ""
 14  sdbserver3:11820:21               10752 Task               Job[PageCleaner]
 15  sdbserver3:11820:3                10734 Task               Job[Prefetcher]
 16  sdbserver3:11820:4                10735 Task               Job[Prefetcher]
 17  sdbserver3:11820:42               10847 ReplAgent          NodeID:1000,TID:1,Start:active
 18  sdbserver3:11820:5                10736 Task               Job[Prefetcher]
 19  sdbserver3:11820:59               23263 ShardAgent         NetID:1,TID:23262
 20  sdbserver3:11820:6                10737 Task               Job[Prefetcher]
 21  sdbserver3:11820:7                10738 Task               Job[Prefetcher]
 22  sdbserver3:11820:8                10739 Task               Job[Prefetcher]</pre>

        <p class="p">4. 按‘A’键，并输入‘TID’，列表结果按照 TID 进行顺序排序</p>

        <pre class="pre codeblock">refresh= 2 secs                             sdbtop 1.0                        snapshotMode: GLOBAL
displayMode: ABSOLUTE                        Sessions                      snapshotModeInput: NULL
hostname: sdbserver3                                                           filtering Number: 0
servicename: 11810                                             sortingWay: NULL sortingField: NULL
usrName: test                                                        Refresh: F5, Quit: q, Help: h

     SessionID                           TID Type               Name
     ------------------------------ -------- ------------------ ------------------------------
  1  sdbserver3:11820:1                10732 LogWriter          ""
  2  sdbserver3:11820:10               10741 Task               Job[Prefetcher]
  3  sdbserver3:11820:11               10742 Task               Job[Prefetcher]
  4  sdbserver3:11820:12               10743 Task               Job[Prefetcher]
  5  sdbserver3:11820:13               10744 Cluster            ""
  6  sdbserver3:11820:14               10745 ClusterShard       ""
  7  sdbserver3:11820:15               10746 ClusterLogNotify   ""
  8  sdbserver3:11820:16               10747 ShardReader        ""
  9  sdbserver3:11820:17               10748 ReplReader         ""
 10  sdbserver3:11820:18               10749 SyncClockWorker    ""
 11  sdbserver3:11820:19               10750 TCPListener        ""
 12  sdbserver3:11820:2                10733 DpsRollback        ""
 13  sdbserver3:11820:20               10751 RestListener       ""
 14  sdbserver3:11820:21               10752 Task               Job[PageCleaner]
 15  sdbserver3:11820:3                10734 Task               Job[Prefetcher]
 16  sdbserver3:11820:4                10735 Task               Job[Prefetcher]
 17  sdbserver3:11820:42               10847 ReplAgent          NodeID:1000,TID:1,Start:active
 18  sdbserver3:11820:5                10736 Task               Job[Prefetcher]
 19  sdbserver3:11820:59               23263 ShardAgent         NetID:1,TID:23262
 20  sdbserver3:11820:6                10737 Task               Job[Prefetcher]
 21  sdbserver3:11820:7                10738 Task               Job[Prefetcher]
 please input the displayName which need order by asc : TID</pre>

        <p class="p">5. 按‘N’键，并输入1，列表中将原来行号为1的记录过滤不显示</p>

        <p class="p">6. 按‘W’键，返回没有按行号进行过滤前的列表信息</p>

        <p class="p">7. 按‘C’键，并输入‘TID：10732”进行筛选，则只显示 TID 值为10732的记录</p>

        <pre class="pre codeblock">refresh= 2 secs                             sdbtop 1.0                        snapshotMode: GLOBAL
displayMode: ABSOLUTE                        Sessions                      snapshotModeInput: NULL
hostname: sdbserver3                                                           filtering Number: 0
servicename: 11810                                             sortingWay: NULL sortingField: NULL
usrName: test                                                        Refresh: F5, Quit: q, Help: h

     SessionID                           TID Type               Name
     ------------------------------ -------- ------------------ ------------------------------
  1  sdbserver3:11820:1                10732 LogWriter          ""
  2  sdbserver3:11820:10               10741 Task               Job[Prefetcher]
  3  sdbserver3:11820:11               10742 Task               Job[Prefetcher]
  4  sdbserver3:11820:12               10743 Task               Job[Prefetcher]
  5  sdbserver3:11820:13               10744 Cluster            ""
  6  sdbserver3:11820:14               10745 ClusterShard       ""
  7  sdbserver3:11820:15               10746 ClusterLogNotify   ""
  8  sdbserver3:11820:16               10747 ShardReader        ""
  9  sdbserver3:11820:17               10748 ReplReader         ""
 10  sdbserver3:11820:18               10749 SyncClockWorker    ""
 11  sdbserver3:11820:19               10750 TCPListener        ""
 12  sdbserver3:11820:2                10733 DpsRollback        ""
 13  sdbserver3:11820:20               10751 RestListener       ""
 14  sdbserver3:11820:21               10752 Task               Job[PageCleaner]
 15  sdbserver3:11820:3                10734 Task               Job[Prefetcher]
 16  sdbserver3:11820:4                10735 Task               Job[Prefetcher]
 17  sdbserver3:11820:42               10847 ReplAgent          NodeID:1000,TID:1,Start:active
 18  sdbserver3:11820:5                10736 Task               Job[Prefetcher]
 19  sdbserver3:11820:59               23263 ShardAgent         NetID:1,TID:23262
 20  sdbserver3:11820:6                10737 Task               Job[Prefetcher]
 21  sdbserver3:11820:7                10738 Task               Job[Prefetcher]
 please input the filter condition : TID:10732</pre>

        <p class="p">8. 按‘Q’键，返回没有按照筛选条件前的列表信息</p>

        <p class="p">9. 按‘&lt;’或者‘&gt;’键，可以查看隐藏在左边或者右边的列</p>

      </li>

    </ul>
    
  </div>

<div class="related-links"/>
<div class="navfooter"><a class="link" href="../../../../administration/database/database_tool/topics/database_tool.html" title="数据库工具"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">数据库工具</span></a>  <script type="text/javascript"><!--         
    function expand(){
        parent.tocwin.expandToTopic(window.location.href, this.getAttribute('href'));
    }
    var aArray = document.getElementsByTagName('a');
    var i;
    for (i = 0; i< aArray.length; i++){
      aArray[i].onclick = expand;
    }
//--></script></div><div class="footer"><a href="http://www.sequoiadb.com" target="_blank"><img src="../../../../assets/images/sequoiadb_logo.png" alt="SequoiaDB"/></a>SequoiaDB Version 1.11
          
    </div>
</body>
</html>