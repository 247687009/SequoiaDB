
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="topic"/>
<meta name="DC.Title" content="db.snapshot()"/>
<meta name="description" content="db.snapshot(&lt;snapType&gt;,[cond],[sel],[sort]) 枚举快照，快照是一种得到当前系统状态的命令。 查看更多有关快照信息 参数描述 参数名 参数类型 描述 是否必填 snapType 枚举 快照类型 。 是 cond Json 对象 选择条件，只返回 cond 字段指定的节点或分区组的快照信息，为 null 时，返回整个集群的快照信息。 否 sel Json 对象 ..."/>
<meta name="DC.Relation" scheme="URI" content="listReplicaGroups.html"/>
<meta name="DC.Relation" scheme="URI" content="resetSnapshot.html"/>
<meta name="DC.Relation" scheme="URI" content="../../../administration/database/topics/EDU.html"/>
<meta name="DC.Relation" scheme="URI" content="../../console/topics/console.html"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="references_method_snapshot"/>
<link rel="stylesheet" type="text/css" href="../../../commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../../assets/webhelp_topic.css"/>
<title>db.snapshot()</title>
<script type="text/javascript" src="../../../assets/jquery-1.3.2.js"> </script><script type="text/javascript" src="../../../assets/jquery-ui-1.8.2.custom.min.js"> </script><script type="text/javascript" src="../../../assets/frames_redirect.js"> </script><script type="text/javascript"><!--
    var prefix = "../../../../index.html";
    var ratingFile = "";
    redirectToToc(window.location.search);
    function highlightSearchTerm(){
        if(parent.termsToHighlight != null){
        // highlight each term in the content view  
          for(i = 0 ; i < parent.termsToHighlight.length ; i++){        
              $('*', window.parent.frames[1].document).highlight(parent.termsToHighlight[i]);
          }
        }
    }
//--></script></head>
<body onload="highlightSearchTerm()" id="references_method_snapshot"><a name="references_method_snapshot"><!-- --></a>
<table class="nav"><tbody><tr><td><div class="navheader"><span class="frames" onclick="redirectFrames(location.pathname)"><script type="text/javascript"><!--
  if (parent.window.location.pathname == window.location.pathname ) document.write('With Frames');                    
                    --></script></span></div></td><td width="50%"/></tr></tbody></table>

  <h1 class="title topictitle1">db.snapshot()</h1>

  <div class="body">
    <div class="section"><h2 class="title sectiontitle">db.snapshot(&lt;snapType&gt;,[cond],[sel],[sort])</h2>
      <p class="p">枚举快照，快照是一种得到当前系统状态的命令。<a class="xref" href="../../../administration/database/topics/monitoring.html">查看更多有关快照信息</a></p>

    </div>

    <div class="section"><h2 class="title sectiontitle">参数描述</h2>
      <table cellpadding="4" cellspacing="0" summary="" border="1" class="simpletable"><tr class="sthead">
          <th valign="bottom" align="left" id="d153893e29" class="stentry">参数名</th>

          <th valign="bottom" align="left" id="d153893e32" class="stentry">参数类型</th>

          <th valign="bottom" align="left" id="d153893e35" class="stentry">描述</th>

          <th valign="bottom" align="left" id="d153893e38" class="stentry">是否必填</th>

        </tr>
<tr class="strow">
          <td valign="top" headers="d153893e29" class="stentry">snapType</td>

          <td valign="top" headers="d153893e32" class="stentry">枚举</td>

          <td valign="top" headers="d153893e35" class="stentry"><a class="xref" href="../../../administration/database/topics/monitoring.html">快照类型</a>。</td>

          <td valign="top" headers="d153893e38" class="stentry">是</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d153893e29" class="stentry">cond</td>

          <td valign="top" headers="d153893e32" class="stentry">Json 对象</td>

          <td valign="top" headers="d153893e35" class="stentry">选择条件，只返回 cond 字段指定的节点或分区组的快照信息，为 null 时，返回整个集群的快照信息。</td>

          <td valign="top" headers="d153893e38" class="stentry">否</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d153893e29" class="stentry">sel</td>

          <td valign="top" headers="d153893e32" class="stentry">Json 对象</td>

          <td valign="top" headers="d153893e35" class="stentry">选择返回字段名。为 null 时，返回所有的字段名。</td>

          <td valign="top" headers="d153893e38" class="stentry">否</td>

        </tr>
<tr class="strow">
          <td valign="top" headers="d153893e29" class="stentry">sort</td>

          <td valign="top" headers="d153893e32" class="stentry">Json 对象</td>

          <td valign="top" headers="d153893e35" class="stentry">对返回的记录按选定的字段排序。1为升序；-1为降序。</td>

          <td valign="top" headers="d153893e38" class="stentry">否</td>

        </tr>
</table>

      
    </div>

    <div class="section"><h2 class="title sectiontitle">格式</h2>
      <p class="p">snapshot() 方法定义格式有 snapType，cond两个字段，snapType 为枚举类型，cond 为 Json 对象，格式如下：</p>

      <pre class="pre codeblock">{"snapType":"&lt;快照类型&gt;",["cond":"{"字段名1":{"操作符1":"值1"},"字段名2":{"操作符2":"值2"}...}"]}</pre>

      <div class="note note"><span class="notetitle">Note:</span> 
        <ul class="ul">
          <li class="li">snapType 字段的值请参考<a class="xref" href="../../../administration/database/topics/monitoring.html">快照类型</a></li>

          <li class="li">sel 参数是一个 json 结构，字段名的值一般指定为空串。如果指定为如下结构：{"字段名1":"值1","字段名2":"值2",...}，对于记录中存在所选字段名的话，设定的值其实无效；对于记录中不存在所选字段名的话，返回{"字段名1":"值1","字段名2":"值2",...}</li>

          <li class="li">字段的值是数组的话，我们用“.”操作符引用数组内的元素。并加上双引号（""）</li>

        </ul>

      </div>

    </div>

    <div class="section"><h2 class="title sectiontitle">示例</h2>
      <ul class="ul">
        <li class="li">
          <div class="p">指定 snapType 的值为 SDB_SNAP_CONTEXTS：<pre class="pre codeblock">db.snapshot(SDB_SNAP_CONTEXTS)</pre>
</div>

          <p class="p"> 返回整个集群的上下文快照：</p>

          <pre class="pre codeblock">{
  "SessionID": "vmsvr1-cent-x64-1:11820:22",
  "Contexts": [
    {
      "ContextID": 8,
      "Type": "DUMP",
      "Description": "BufferSize:0",
      "DataRead": 0,
      "IndexRead": 0,
      "QueryTimeSpent": 0,
      "StartTimestamp": "2013-12-28-16.07.59.146399"
    }
  ]
}
{
  "SessionID": "vmsvr1-cent-x64-1:11830:22",
  "Contexts": [
    {
      "ContextID": 6,
      "Type": "DUMP",
      "Description": "BufferSize:0",
      "DataRead": 0,
      "IndexRead": 0,
      "QueryTimeSpent": 0,
      "StartTimestamp": "2013-12-28-16.07.59.147576"
    }
  ]
}
{
  "SessionID": "vmsvr1-cent-x64-1:11840:23",
  "Contexts": [
    {
      "ContextID": 7,
      "Type": "DUMP",
      "Description": "BufferSize:0",
      "DataRead": 0,
      "IndexRead": 0,
      "QueryTimeSpent": 0,
      "StartTimestamp": "2013-12-28-16.07.59.148603"
    }
  ]
}</pre>

        </li>

        <li class="li"><p class="p">通过组名或组 ID 查询某个分区组的快照信息，如：</p>

          <div class="p"><pre class="pre codeblock">db.snapshot(SDB_SNAP_CONTEXTS,{GroupName:'data1'})</pre>
返回组名为“data1”的分区组快照信息
            <pre class="pre codeblock">db.snapshot(SDB_SNAP_CONTEXTS,{GroupID:1000})</pre>
返回组 ID 为“1000”的分区组快照信息</div>

          <pre class="pre codeblock">{
  "SessionID": "vmsvr1-cent-x64-1:11820:22",
  "Contexts": [
    {
      "ContextID": 11,
      "Type": "DUMP",
      "Description": "BufferSize:0",
      "DataRead": 0,
      "IndexRead": 0,
      "QueryTimeSpent": 0,
      "StartTimestamp": "2013-12-28-16.13.57.864245"
    }
  ]
}
{
  "SessionID": "vmsvr1-cent-x64-1:11840:23",
  "Contexts": [
    {
      "ContextID": 10,
      "Type": "DUMP",
      "Description": "BufferSize:0",
      "DataRead": 0,
      "IndexRead": 0,
      "QueryTimeSpent": 0,
      "StartTimestamp": "2013-12-28-16.13.57.865103"
    }
  ]
}</pre>
</li>

        <li class="li"><p class="p">通过“组名+主机名+服务名”或“组 ID+节点 ID”查询某个节点的快照信息，如：</p>

          <div class="p"><pre class="pre codeblock">db.snapshot(SDB_SNAP_CONTEXTS,{GroupName:'data1',HostName:"vmsvr1-cent-x64-1",svcname:"11820"})</pre>

            <pre class="pre codeblock">db.snapshot(SDB_SNAP_CONTEXTS,{GroupID:1000,NodeID:1001})</pre>
</div>

          <pre class="pre codeblock">{
  "SessionID": "vmsvr1-cent-x64-1:11820:22",
  "Contexts": [
    {
      "ContextID": 11,
      "Type": "DUMP",
      "Description": "BufferSize:0",
      "DataRead": 0,
      "IndexRead": 0,
      "QueryTimeSpent": 0,
      "StartTimestamp": "2013-12-28-16.13.57.864245"
    }
  ]
  }</pre>
</li>

        <li class="li"><p class="p">通过“主机名+服务名”查询某个节点的快照信息，如：</p>

          <div class="p"><pre class="pre codeblock">db.snapshot(SDB_SNAP_CONTEXTS,{HostName:"vmsvr1-cent-x64-1",svcname:"11820"})</pre>
</div>

        </li>
 
      </ul>

    </div>

  </div>

  <div class="related-links"><div class="relinfo"><strong>Related information</strong><br/>
<div><a class="navheader_parent_path" href="listReplicaGroups.html" title="db.listReplicaGroups()">db.listReplicaGroups()</a></div>
<div><a class="navheader_parent_path" href="resetSnapshot.html" title="db.resetSnapshot()">db.resetSnapshot()</a></div>
<div><a class="navheader_parent_path" href="../../../administration/database/topics/EDU.html" title="引擎调度单元">引擎调度单元</a></div>
<div><a class="navheader_parent_path" href="../../console/topics/console.html" title="操作符">操作符</a></div>
</div>
</div>
<div class="navfooter"><script type="text/javascript"><!--         
    function expand(){
        parent.tocwin.expandToTopic(window.location.href, this.getAttribute('href'));
    }
    var aArray = document.getElementsByTagName('a');
    var i;
    for (i = 0; i< aArray.length; i++){
      aArray[i].onclick = expand;
    }
//--></script></div><div class="footer"><a href="http://www.sequoiadb.com" target="_blank"><img src="../../../assets/images/sequoiadb_logo.png" alt="SequoiaDB"/></a>SequoiaDB Version 1.11
          
    </div>
</body>
</html>